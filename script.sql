insert into public.MTDATA_DATA_EVNT_TGT
(customerreferencecode,
instancename,
fleetid,
vehicleid,
deviceid,
devicetype,
serialnumber,
devicetime,
gpstime,
arrivaltimestamp,
latitude,
longitude,
flags,
direction,
speed,
maxspeed,
inputstatus,
statusflag,
outputstatus,
buttonstatus,
lightstatus,
sparestatus,
satellites_altitude,
satellites_noinview,
satellites_hdop,
speedaccuracydp,
gpsodometer,
drivername,
driverlogin,
driverpin,
cardtype,
drivercarddata,
speedaccuracydecimalplaces,
maxspeedaccuracydecimalplaces,
ecmflags,
hasgforce,
cardidaslong,
unitstatus,
currentsetpointid,
currentsetpointgroup,
currentsetpointnumber,
currentvehicleroutescheduleid,
currentroutecheckpointindex,
hdop,
numofsattelites,
coolanttemperature,
oiltemperature,
oilpressure,
gear,
maxrpm,
brakeapplications,
gforcefront,
gforceback,
gforceleftright,
schoolzone,
isprivate,
roadtype,
streetnumber,
street,
suburb,
city,
state,
country,
postcode,
speedlimit,
currentdatetime
)
select distinct *, to_char(current_timestamp,'YYYYMMDDHHMISS')  from MTDATA_DATA_EVNT
where (CustomerReferenceCode,instancename,fleetid,vehicleid,deviceid,serialnumber,devicetime,gpstime) not in
(select CustomerReferenceCode,instancename,fleetid,vehicleid,deviceid,serialnumber,devicetime,gpstime from MTDATA_DATA_EVNT_TGT)
and devicetime is not null and gpstime is not null;